# QuickStar - Stream Agent

ä¸€ä¸ªåŸºäº ReActï¼ˆReasoning and Actingï¼‰æ¨¡å¼çš„ AI ä»£ç†ç³»ç»Ÿï¼Œæ”¯æŒ**å®æ—¶æµå¼è¾“å‡º**ã€å·¥å…·è°ƒç”¨å’Œç”¨æˆ·äº¤äº’ã€‚

## ğŸš€ æ–°ç‰¹æ€§ - æµå¼è¾“å‡º

Chapter3 çš„ä¸»è¦å‡çº§æ˜¯**å®æ—¶æµå¼è¾“å‡º**åŠŸèƒ½ï¼š
- âœ¨ **å®æ—¶å“åº”**ï¼šç”¨æˆ·å¯ä»¥çœ‹åˆ°AIåŠ©æ‰‹é€å­—ç”Ÿæˆå›å¤ï¼Œå°±åƒçœŸäººæ‰“å­—ä¸€æ ·
- ğŸ”„ **æµå¼å·¥å…·è°ƒç”¨**ï¼šæ”¯æŒåœ¨æµå¼æ¨¡å¼ä¸‹å¤„ç†å·¥å…·è°ƒç”¨
- ğŸ’¡ **ä¼˜é›…é™çº§**ï¼šå¦‚æœæµå¼æ¨¡å¼å¤±è´¥ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°æ ‡å‡†æ¨¡å¼
- ğŸ¯ **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šå‡å°‘ç­‰å¾…æ—¶é—´ï¼Œæå‡äº¤äº’æ„Ÿå—

## ç³»ç»Ÿæ¶æ„

![ReActæ¶æ„å›¾](./images/ReAct_architect.png)

ReActï¼ˆReasoning and Actingï¼‰æ¶æ„é€šè¿‡ä»¥ä¸‹æ ¸å¿ƒæµç¨‹å®ç°æ™ºèƒ½ä»£ç†ï¼š

1. **æ€è€ƒï¼ˆThinkï¼‰**ï¼šAI æ¨¡å‹æ¥æ”¶è¾“å…¥å¹¶è¿›è¡Œæ¨ç†
2. **è¡ŒåŠ¨ï¼ˆActï¼‰**ï¼šåŸºäºæ¨ç†ç»“æœè°ƒç”¨ç›¸åº”å·¥å…·
3. **è§‚å¯Ÿï¼ˆObserveï¼‰**ï¼šè·å–å·¥å…·æ‰§è¡Œç»“æœä½œä¸ºåé¦ˆ
4. **å¾ªç¯è¿­ä»£**ï¼šå°†è§‚å¯Ÿç»“æœè¾“å…¥ä¸‹ä¸€è½®æ€è€ƒï¼Œå½¢æˆå®Œæ•´çš„æ¨ç†-è¡ŒåŠ¨å¾ªç¯

è¿™ç§æ¶æ„ä½¿ AI ä»£ç†èƒ½å¤Ÿåœ¨å¤æ‚ä»»åŠ¡ä¸­ä¿æŒè¿è´¯çš„æ¨ç†é“¾ï¼Œå¹¶é€šè¿‡å·¥å…·è°ƒç”¨ä¸å¤–éƒ¨ç¯å¢ƒäº¤äº’ã€‚

## æ ¸å¿ƒç»„ä»¶

### ğŸŒŠ APIClient - æµå¼APIå®¢æˆ·ç«¯

[`APIClient`](src/core/api_client.py) ç°åœ¨æ”¯æŒä¸¤ç§æ¨¡å¼ï¼š

**æ ‡å‡†æ¨¡å¼**ï¼ˆå…¼å®¹ Chapter2ï¼‰ï¼š
```python
def get_completion(self, request_params) -> Message
```

**ğŸ†• æµå¼æ¨¡å¼**ï¼ˆChapter3 æ–°å¢ï¼‰ï¼š
```python
def get_completion_stream(self, request_params) -> Generator[str, None, None]
```

æµå¼æ¨¡å¼ç‰¹ç‚¹ï¼š
- é€å—è¿”å›AIç”Ÿæˆçš„å†…å®¹
- æ”¯æŒå·¥å…·è°ƒç”¨åœ¨æµå¼å“åº”ä¸­çš„å¤„ç†
- è‡ªåŠ¨æ„å»ºå®Œæ•´çš„å“åº”æ¶ˆæ¯å¯¹è±¡
- å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æ¢å¤

### ğŸ’¬ Conversation - æµå¼å¯¹è¯ç®¡ç†å™¨

![Conversationæ—¶åºå›¾](./images/conversation.png)

[`Conversation`](src/core/conversation.py) çš„æµå¼å¢å¼ºï¼š

**ğŸ†• æµå¼è¾“å‡ºæ–¹æ³•**ï¼š
- `print_streaming_content()` - å®æ—¶æ˜¾ç¤ºAIç”Ÿæˆçš„å†…å®¹ç‰‡æ®µ
- `recursive_message_handling()` - å‡çº§æ”¯æŒæµå¼å¤„ç†

**æ ¸å¿ƒæµç¨‹**ï¼š
1. ğŸ”„ å‘é€æ¶ˆæ¯åˆ° AI æ¨¡å‹ï¼ˆæµå¼ï¼‰
2. ğŸ“º å®æ—¶æ˜¾ç¤ºAIå›å¤å†…å®¹
3. ğŸ” æ£€æŸ¥å“åº”æ˜¯å¦åŒ…å«å·¥å…·è°ƒç”¨
4. âœ‹ å¦‚éœ€æ‰¹å‡†ï¼Œç­‰å¾…ç”¨æˆ·ç¡®è®¤
5. âš¡ æ‰§è¡Œå·¥å…·å¹¶å°†ç»“æœåé¦ˆç»™ AI
6. ğŸ” é€’å½’ç»§ç»­å¯¹è¯

### ToolManager å·¥å…·ç®¡ç†å™¨

[`ToolManager`](src/tools/tool_manager.py) ä¿æŒä¸å˜ï¼Œå®Œå…¨å…¼å®¹æµå¼æ¨¡å¼ï¼š

- **å·¥å…·æ³¨å†Œ**ï¼šç»Ÿä¸€ç®¡ç†æ‰€æœ‰å¯ç”¨å·¥å…·
- **æè¿°ç”Ÿæˆ**ï¼šä¸º AI æä¾›å·¥å…·çš„ JSON Schema æè¿°
- **æ‰§è¡Œä»£ç†**ï¼šæ ¹æ®å·¥å…·åç§°åˆ†å‘æ‰§è¡Œè¯·æ±‚

### å·¥å…·ç³»ç»Ÿ

æ‰€æœ‰å·¥å…·ç»§æ‰¿è‡ª [`BaseAgent`](src/tools/base_agent.py)ï¼Œç›®å‰å®ç°äº†ï¼š

- **CmdRunner**ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œæ”¯æŒè¶…æ—¶æ§åˆ¶å’Œç”¨æˆ·æ‰¹å‡†

## ğŸ® ä½¿ç”¨ä½“éªŒå¯¹æ¯”

### Chapter2 (æ ‡å‡†æ¨¡å¼)
```
ğŸ‘¤ è¯·è¾“å…¥: å¸®æˆ‘åˆ—å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶
ğŸ¤– [ç­‰å¾…3-5ç§’] æˆ‘æ¥å¸®ä½ åˆ—å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶...
```

### Chapter3 (æµå¼æ¨¡å¼) âœ¨
```
ğŸ‘¤ è¯·è¾“å…¥: å¸®æˆ‘åˆ—å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶
ğŸ¤– æˆ‘æ¥å¸®ä½ åˆ—å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶...
[å®æ—¶é€å­—æ˜¾ç¤ºï¼Œæ— éœ€ç­‰å¾…]
```

## å¿«é€Ÿå¼€å§‹

```bash
# å®‰è£…ä¾èµ–
pip install -e .

# è¿è¡Œç¨‹åº
quickstar

# æµ‹è¯•æµå¼åŠŸèƒ½
python test_streaming.py
```

## é…ç½®è¯´æ˜

API é…ç½®åœ¨ [`APIClient`](src/core/api_client.py) ä¸­ï¼š
- ä½¿ç”¨ OpenRouter ä½œä¸º API ç½‘å…³
- é»˜è®¤æ¨¡å‹ï¼šClaude Sonnet 4
- æ”¯æŒè‡ªå®šä¹‰ API Key å’Œ Base URL
- ğŸ†• æµå¼è¯·æ±‚è‡ªåŠ¨è®¾ç½® `stream=True`

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### æµå¼å“åº”å¤„ç†
```python
for chunk in stream:
    if chunk.choices[0].delta.content:
        content_chunk = chunk.choices[0].delta.content
        full_content += content_chunk
        yield content_chunk  # å®æ—¶è¾“å‡º
```

### å·¥å…·è°ƒç”¨åœ¨æµå¼ä¸­çš„å¤„ç†
```python
# åœ¨æµå¼å“åº”ä¸­æ”¶é›†å·¥å…·è°ƒç”¨ä¿¡æ¯
if hasattr(chunk.choices[0].delta, 'tool_calls'):
    # é€æ­¥æ„å»ºå·¥å…·è°ƒç”¨å¯¹è±¡
    # ç¡®ä¿å·¥å…·è°ƒç”¨ä¿¡æ¯å®Œæ•´
```

### é”™è¯¯å¤„ç†å’Œé™çº§
```python
try:
    # å°è¯•æµå¼æ¨¡å¼
    for chunk in stream_generator:
        # å¤„ç†æµå¼å“åº”
except Exception as e:
    # è‡ªåŠ¨é™çº§åˆ°æ ‡å‡†æ¨¡å¼
    response = self._api_client.get_completion(request)
```

## ğŸ¯ Chapter3 vs Chapter2

| ç‰¹æ€§ | Chapter2 | Chapter3 |
|------|----------|----------|
| å“åº”æ¨¡å¼ | æ‰¹é‡è¿”å› | ğŸ†• å®æ—¶æµå¼ |
| ç”¨æˆ·ä½“éªŒ | éœ€è¦ç­‰å¾… | ğŸ†• å³æ—¶åé¦ˆ |
| å·¥å…·è°ƒç”¨ | âœ… æ”¯æŒ | âœ… æµå¼æ”¯æŒ |
| é”™è¯¯å¤„ç† | âœ… åŸºç¡€ | ğŸ†• ä¼˜é›…é™çº§ |
| ä»£ç å…¼å®¹ | - | âœ… å‘åå…¼å®¹ |

è¿™ä¸ªæ¡†æ¶çš„æ ¸å¿ƒæ€æƒ³æ˜¯è®© AI èƒ½å¤Ÿ"æ€è€ƒ"ï¼ˆé€šè¿‡å¯¹è¯ï¼‰å’Œ"è¡ŒåŠ¨"ï¼ˆé€šè¿‡å·¥å…·è°ƒç”¨ï¼‰ï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œå¯èƒ½æœ‰é£é™©çš„æ“ä½œæ—¶éœ€è¦ç”¨æˆ·ç¡®è®¤ã€‚Chapter3 çš„æµå¼è¾“å‡ºè¿›ä¸€æ­¥æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œè®©äº¤äº’æ›´åŠ è‡ªç„¶æµç•…ã€‚

## ğŸ¨ UI Changes

### Recent Updates
- Enhanced user interface for better streaming experience
- Improved visual feedback during tool execution
- Updated progress indicators for real-time interactions
- Optimized layout for better readability in streaming mode

